# ZTE MC888 Ultra Daemon Toolkit

This repository contains a Click-based `zte` CLI and supporting libraries for
working with the ZTE MC888 Ultra modem. The toolkit focuses on driving the
modem's REST endpoints, capturing telemetry snapshots, and preparing Markdown
documentation for discovered endpoints while developers iterate without live
hardware.

## Prerequisites
- Python 3.12 (managed via [uv](https://github.com/astral-sh/uv) if desired)
- Dependencies declared in `pyproject.toml` (Click, httpx, pytest, ruff)

```bash
uv python install 3.12
uv sync
```

If you prefer pip, install dependencies from `pyproject.toml` with
`pip install -e .`.

## Quick Start

### Discover modem endpoints

Use the REST-capable `zte discover` command to explore endpoints and capture
fixtures.

```bash
uv run zte discover \
  --host 192.168.0.1 \
  --password secret \
  --path "goform/goform_get_cmd_process?isTest=false&cmd=lan_station_list" \
  --target-file docs/discover/lan_station_list.md
```

The command authenticates with the modem, prints the JSON response, writes a
Markdown transcript, and stores a sibling JSON payload via
`zte_daemon.lib.snapshots.write_snapshot` for re-use in tests.

### Read a single metric

```bash
uv run zte read RSRP1 --host 192.168.0.1 --password secret
```

The CLI fetches a fresh REST snapshot and prints the requested metric. Unknown
metrics trigger an error listing the supported keys.

### Run a daemon cycle

```bash
uv run zte run --device-pass secret --log info --foreground
```

This command authenticates, retrieves a telemetry snapshot, echoes headline
metrics, and records an MQTT payload to `logs/mqtt-mock.jsonl` through the
mocked broker.

## Capturing Fixtures & Documentation

- Markdown and JSON examples live under `docs/discover/`; the seeded
  `lan_station_list.md` demonstrates the format generated by `--target-file`.
- Detailed command descriptions are maintained in [`docs/cli.md`](docs/cli.md).
- Metric coverage and definitions are documented in [`docs/metrics.md`](docs/metrics.md).

## Tests & Linting

Run the project checks with:

```bash
uv run ruff check .
uv run pytest
```

Contract, unit, and integration suites exercise the REST client, CLI flows, and
mocked MQTT publisher to ensure the toolkit remains regression-free.
